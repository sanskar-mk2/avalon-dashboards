import{r as x,j as f,p as C,s as k,q as F,g as o,o as n,b as a,F as S,x as j,y as D,a as N,w as B,d as E,t as h,u as _,l as O}from"./app-B2GYkFaq.js";import{C as y,p as R,t as U,a as A}from"./chartjs-plugin-datalabels.esm-Fgtg15OK.js";const I={class:"flex justify-center flex-wrap sm:flex-nowrap mt-10 gap-8"},M={class:"sm:basis-1/3 w-full mx-4 sm:mx-0 card bg-base-100 p-4"},T={key:0,class:"text-center py-12 text-base-content/50"},V={key:1,class:"h-full sm:h-[250px] overflow-y-auto"},W={class:"min-w-full bg-base-100 border border-base-300 rounded-lg overflow-hidden"},z={class:"divide-y divide-base-300"},q={class:"px-4 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-xs sm:text-sm text-base-content"},G={class:"px-4 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-xs sm:text-sm text-base-content"},H={class:"sm:basis-2/3 w-full mx-4 sm:mx-0 card bg-base-100 p-4"},K={key:0,class:"text-center py-12 text-base-content/50"},L={key:1,class:"h-[250px]"},Q={__name:"CustomerCharts",props:{sales_by_customer:Object,top_sales_by_customer:Object,month:String,additional_filters:Object},setup(p){y.register(R);const l=p,c=x(null);let i=null;const m=x(null),g=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}),u=f(()=>{var e,t;return((t=(e=l.sales_by_customer)==null?void 0:e.labels)==null?void 0:t.length)>0}),b=f(()=>{const e=U[m.value];if(!e)return{};const t=Object.keys(e).filter(r=>!r.startsWith("--")&&r!=="color-scheme"&&r!=="fontFamily"),s={};return t.forEach(r=>{s[r]=new A(e[r]).toGamut({space:"srgb"}).to("srgb").toString({format:"hex"})}),s}),d=()=>{if(i&&(i.destroy(),i=null),!u.value||!c.value)return;const e={...l.sales_by_customer};e.datasets=e.datasets.map(t=>({...t,backgroundColor:b.value.primary+"80",borderColor:b.value.primary,borderWidth:1})),e.datasets.reverse(),i=new y(c.value,{type:"bar",data:e,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:3,onHover:(t,s)=>{t.native.target.style.cursor=s.length?"pointer":"default"},onClick:(t,s,r)=>{if(s.length>0){const v=s[0].index,w=r.data.labels[v];D.get(route("sales.index"),{"filter[customer_name]":w,"filter[period]":l.month,...l.additional_filters})}},scales:{y:{ticks:{callback:function(t){return t>=1e6?(t/1e6).toFixed(1)+"M":(t/1e3).toFixed(1)+"K"}}}},plugins:{legend:{labels:{font:{size:10},boxWidth:10}},datalabels:{color:"white",formatter:function(t){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",notation:"compact",maximumFractionDigits:1}).format(t)},backgroundColor:function(t){return t.dataset.borderColor},borderRadius:4,padding:4,font:{weight:"bold",size:10},display:function(t){return t.dataset.data[t.dataIndex]!==0},anchor:"end",align:"end"}}}})};return new MutationObserver(e=>{e.some(t=>t.attributeName==="data-theme")&&(m.value=document.documentElement.getAttribute("data-theme"),d())}).observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),C(()=>l.sales_by_customer,()=>{k(()=>{d()})},{deep:!0}),F(()=>{m.value=document.documentElement.getAttribute("data-theme"),d()}),(e,t)=>(n(),o("div",I,[a("div",M,[t[1]||(t[1]=a("h2",{class:"text-lg sm:text-xl font-semibold mb-4"}," Sales By Customer ",-1)),u.value?(n(),o("div",V,[a("table",W,[t[0]||(t[0]=a("thead",{class:"bg-primary sticky top-0"},[a("tr",null,[a("th",{class:"px-4 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-primary-content uppercase tracking-wider"}," Customer "),a("th",{class:"px-4 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-primary-content uppercase tracking-wider"}," Sales ")])],-1)),a("tbody",z,[(n(!0),o(S,null,j(p.top_sales_by_customer,s=>(n(),o("tr",{key:s.customer_name,class:"hover:bg-base-200"},[a("td",q,[N(_(O),{href:e.route("customers.show",s.customer_name),class:"link"},{default:B(()=>[E(h(s.customer_name),1)]),_:2},1032,["href"])]),a("td",G,h(_(g).format(s.total_sales)),1)]))),128))])])])):(n(),o("div",T," No data available "))]),a("div",H,[t[2]||(t[2]=a("h2",{class:"text-lg sm:text-xl font-semibold mb-4"}," Sales By Customer ",-1)),u.value?(n(),o("div",L,[a("canvas",{ref_key:"customerChartRef",ref:c},null,512)])):(n(),o("div",K," No data available "))])]))}};export{Q as _};
