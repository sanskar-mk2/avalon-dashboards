import{r as x,j as f,p as C,s as S,q as F,g as o,o as n,b as a,F as j,x as D,y as N,a as B,w as E,d as I,t as h,u as _,l as O}from"./app-B2GYkFaq.js";import{C as y,p as R,t as U,a as A}from"./chartjs-plugin-datalabels.esm-Fgtg15OK.js";const T={class:"flex justify-center flex-wrap sm:flex-nowrap mt-10 gap-8"},V={class:"sm:basis-1/3 w-full mx-4 sm:mx-0 card bg-base-100 p-4"},W={key:0,class:"text-center py-12 text-base-content/50"},z={key:1,class:"h-full sm:h-[250px] overflow-y-auto"},M={class:"min-w-full bg-base-100 border border-base-300 rounded-lg overflow-hidden"},q={class:"divide-y divide-base-300"},G={class:"px-4 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-xs sm:text-sm text-base-content"},H={class:"px-4 sm:px-6 py-3 sm:py-4 whitespace-nowrap text-xs sm:text-sm text-base-content"},K={class:"sm:basis-2/3 w-full mx-4 sm:mx-0 card bg-base-100 p-4"},L={key:0,class:"text-center py-12 text-base-content/50"},J={key:1,class:"h-[250px]"},Y={__name:"SalespersonCharts",props:{sales_by_salesperson:Object,top_sales_by_salesperson:Object,month:String,additional_filters:Object},setup(u){y.register(R);const l=u,i=x(null);let c=null;const d=x(null),g=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}),m=f(()=>{var t,e;return((e=(t=l.sales_by_salesperson)==null?void 0:t.labels)==null?void 0:e.length)>0}),b=f(()=>{const t=U[d.value];if(!t)return{};const e=Object.keys(t).filter(r=>!r.startsWith("--")&&r!=="color-scheme"&&r!=="fontFamily"),s={};return e.forEach(r=>{s[r]=new A(t[r]).toGamut({space:"srgb"}).to("srgb").toString({format:"hex"})}),s}),p=()=>{if(c&&c.destroy(),!i.value||!m.value)return;const t={...l.sales_by_salesperson};t.datasets=t.datasets.map(e=>({...e,backgroundColor:b.value.primary+"80",borderColor:b.value.primary,borderWidth:1})),t.datasets.reverse(),c=new y(i.value,{type:"bar",data:t,options:{responsive:!0,maintainAspectRatio:!0,aspectRatio:3,onHover:(e,s)=>{e.native.target.style.cursor=s.length?"pointer":"default"},onClick:(e,s,r)=>{if(s.length>0){const v=s[0].index,w=r.data.labels[v],k={"filter[salesperson]":l.sales_by_salesperson.salesperson_mapping[w],"filter[period]":l.month,...l.additional_filters};N.get(route("sales.index"),k)}},scales:{y:{ticks:{callback:function(e){return(e/1e3).toFixed(1)+"K"}}}},plugins:{legend:{labels:{font:{size:10},boxWidth:10}},datalabels:{color:"white",formatter:function(e){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",notation:"compact",maximumFractionDigits:1}).format(e)},backgroundColor:function(e){return e.dataset.borderColor},borderRadius:4,padding:4,font:{weight:"bold",size:10},display:function(e){return e.dataset.data[e.dataIndex]!==0},anchor:"end",align:"end"}}}})};return new MutationObserver(t=>{t.some(e=>e.attributeName==="data-theme")&&(d.value=document.documentElement.getAttribute("data-theme"),p())}).observe(document.documentElement,{attributes:!0,attributeFilter:["data-theme"]}),C(()=>l.sales_by_salesperson,()=>{S(()=>{p()})},{deep:!0}),F(()=>{d.value=document.documentElement.getAttribute("data-theme"),p()}),(t,e)=>(n(),o("div",T,[a("div",V,[e[1]||(e[1]=a("h2",{class:"text-lg sm:text-xl font-semibold mb-4"}," Sales By Salesperson ",-1)),m.value?(n(),o("div",z,[a("table",M,[e[0]||(e[0]=a("thead",{class:"bg-primary sticky top-0"},[a("tr",null,[a("th",{class:"px-4 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-primary-content uppercase tracking-wider"}," Salesperson "),a("th",{class:"px-4 sm:px-6 py-2 sm:py-3 text-left text-xs font-medium text-primary-content uppercase tracking-wider"}," Sales ")])],-1)),a("tbody",q,[(n(!0),o(j,null,D(u.top_sales_by_salesperson,s=>(n(),o("tr",{key:s.id,class:"hover:bg-base-200"},[a("td",G,[B(_(O),{href:t.route("salespeople.show",s.salesperson_model.id),class:"link"},{default:E(()=>[I(h(s.salesperson_model.salesman_name),1)]),_:2},1032,["href"])]),a("td",H,h(_(g).format(s.total_sales)),1)]))),128))])])])):(n(),o("div",W," No data available "))]),a("div",K,[e[2]||(e[2]=a("h2",{class:"text-lg sm:text-xl font-semibold mb-4"}," Sales By Salesperson ",-1)),m.value?(n(),o("div",J,[a("canvas",{ref_key:"salespersonChartRef",ref:i},null,512)])):(n(),o("div",L," No data available "))])]))}};export{Y as _};
