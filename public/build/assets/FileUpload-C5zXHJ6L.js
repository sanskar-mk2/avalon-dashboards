import{C as E,r as b,f as r,o as i,b as e,g as x,t as p,i as f,D as v,u as o,F as g,q as y,d as F,e as C,E as M}from"./app-Dmk3Lh4x.js";const V={class:"grid w-full max-w-sm items-center gap-1.5"},U={class:"form-control w-full max-w-xs"},B={class:"label"},R={class:"label-text text-sm sm:text-base"},A={key:0,class:"border rounded-lg p-4"},q={class:"flex gap-4"},N={class:"form-control w-full max-w-xs"},I=["value"],J={class:"form-control w-full max-w-xs"},Y=["value"],L=["disabled"],$={key:0,class:"loading loading-spinner"},O={id:"confirmDialog",class:"modal"},P={class:"modal-box"},T={class:"modal-action"},W=["disabled"],j=["disabled"],z={method:"dialog"},G=["disabled"],K={__name:"FileUpload",props:{label:{type:String,required:!0},storeRoute:{type:String,required:!0},checkExistingRoute:{type:String,default:null,required:!1},showDateSelectors:{type:Boolean,default:!0}},setup(c){const m=c,l=E({file:null,month:new Date().getMonth()+1,year:new Date().getFullYear(),replace:!1});b(!1);const d=b(!1),n=b(!1),h=a=>{l.file=a.target.files[0]},w=async()=>{d.value=!0;try{(await M.post(route(m.checkExistingRoute),{month:l.month,year:l.year})).data.exists?document.getElementById("confirmDialog").showModal():u()}catch(a){console.error("Error checking existing data:",a)}finally{d.value=!1}},u=()=>{l.post(route(m.storeRoute),{preserveScroll:!0,onStart:()=>n.value=!0,onFinish:()=>{}})},_=a=>{a.preventDefault(),l.file&&(m.checkExistingRoute?w():u())},D=()=>{document.getElementById("confirmDialog").close(),l.replace=!1},k=[{value:1,label:"January"},{value:2,label:"February"},{value:3,label:"March"},{value:4,label:"April"},{value:5,label:"May"},{value:6,label:"June"},{value:7,label:"July"},{value:8,label:"August"},{value:9,label:"September"},{value:10,label:"October"},{value:11,label:"November"},{value:12,label:"December"}],S=Array.from({length:10},(a,t)=>new Date().getFullYear()-5+t);return(a,t)=>(i(),r("form",{onSubmit:C(_,["prevent"]),class:"space-y-3 sm:space-y-4"},[e("div",V,[e("label",U,[e("div",B,[e("span",R,p(c.label)+" CSV File",1)]),e("input",{type:"file",onInput:h,accept:".csv",class:"file-input file-input-bordered w-full max-w-xs text-sm sm:text-base"},null,32),t[4]||(t[4]=e("div",{class:"label"},[e("span",{class:"label-text-alt text-xs sm:text-sm"},"Please upload a CSV file")],-1))]),c.showDateSelectors?(i(),r("fieldset",A,[t[7]||(t[7]=e("legend",{class:"text-sm sm:text-base px-2"},"Uploading for",-1)),e("div",q,[e("label",N,[t[5]||(t[5]=e("div",{class:"label"},[e("span",{class:"label-text text-sm sm:text-base"},"Month")],-1)),f(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>o(l).month=s),class:"select select-bordered w-full max-w-xs text-sm sm:text-base"},[(i(),r(g,null,y(k,s=>e("option",{key:s.value,value:s.value},p(s.label),9,I)),64))],512),[[v,o(l).month]])]),e("label",J,[t[6]||(t[6]=e("div",{class:"label"},[e("span",{class:"label-text text-sm sm:text-base"},"Year")],-1)),f(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>o(l).year=s),class:"select select-bordered w-full max-w-xs text-sm sm:text-base"},[(i(!0),r(g,null,y(o(S),s=>(i(),r("option",{key:s,value:s},p(s),9,Y))),128))],512),[[v,o(l).year]])])])])):x("",!0),e("button",{type:"submit",disabled:!o(l).file||d.value||n.value,class:"btn btn-primary text-sm sm:text-base"},[d.value||n.value?(i(),r("span",$)):x("",!0),t[8]||(t[8]=F(" Upload CSV "))],8,L)]),e("dialog",O,[e("div",P,[t[9]||(t[9]=e("h3",{class:"font-bold text-lg"},"Data Already Exists",-1)),t[10]||(t[10]=e("p",{class:"py-4"}," Data for this month already exists. Would you like to replace the existing data or append new records? ",-1)),e("div",T,[e("button",{onClick:t[2]||(t[2]=s=>{o(l).replace=!0,u()}),disabled:n.value,class:"btn btn-error"}," Replace ",8,W),e("button",{onClick:t[3]||(t[3]=s=>{o(l).replace=!1,u()}),disabled:n.value,class:"btn btn-primary"}," Append ",8,j),e("form",z,[e("button",{onClick:D,disabled:n.value,class:"btn"}," Cancel ",8,G)])])])])],32))}};export{K as _};
